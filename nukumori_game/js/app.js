!function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var r in t)e.d(n,r,function(e){return t[e]}.bind(null,r));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="./",e(e.s=0)}([function(t,e,i){"use strict";var n=Math.floor,r=i(1);i(2),i(3);var o=localStorage.getItem("score");null==o&&localStorage.setItem("score",0);var s=(0,r.init)().canvas;(0,r.initKeys)(),(0,r.initPointer)();var h,a=25,c=1,d=3,u=document.getElementById("score"),l=document.getElementById("point"),f=document.getElementById("help-message"),p=0,g=0,m=!1,w=(0,r.Sprite)({x:s.width,y:s.height-80,color:"#ff0",width:5,height:5,dx:-3,anchor:{x:1,y:1}}),y=(0,r.Sprite)({x:s.width-50,y:s.height-210,color:"#ff0",width:5,height:5,dx:-3,anchor:{x:1,y:1}}),_=(0,r.Sprite)({x:s.width-30,y:s.height-286,color:"#ff0",width:5,height:5,dx:-3,anchor:{x:1,y:1}}),x=(0,r.Sprite)({x:s.width-30,y:s.height-330,color:"#ff0",width:5,height:5,dx:-3,anchor:{x:1,y:1}}),v=(0,r.Sprite)({x:0,y:s.height-50,color:"#a0a0a0",width:s.width,height:50}),b=new Image;b.src="images/character_walk_sheet.png",b.onload=function(){var t=(0,r.SpriteSheet)({image:b,frameWidth:72,frameHeight:97,animations:{walk:{frames:"0..9",frameRate:30},jump:{frames:1,frameRate:1}}}),e=(0,r.Sprite)({x:s.width/2,y:305,anchor:{x:.5,y:.5},animations:t.animations});(h=(0,r.GameLoop)({update:function(){if((0,r.pointerPressed)("left")&&(console.log("left mouse button pressed"),e.y>a&&(e.y-=d)),(0,r.keyPressed)("up")?(console.log("up"),function(t){++p<a&&(t.playAnimation("jump"),t.y-=d)}(e)):p=a,305>e.y?function(t){t.y+=c}(e):function(t){t.playAnimation("walk"),p=0}(e),e.update(),w.update(),y.update(),_.update(),x.update(),0>w.x&&(w.x=s.width),0>y.x&&(y.x=s.width-50),0>_.x&&(_.x=s.width-30),0>x.x&&(x.x=s.width-30),e.collidesWith(w)||e.collidesWith(y)||e.collidesWith(_)||e.collidesWith(x)){console.log("collide"),l.innerHTML=n(g);var t=n(g);o<t&&localStorage.setItem("score",t),g=0,m=!0,h.stop(),f.innerHTML="Restart: Press Enter Key or Click"}else g+=.2;u.innerHTML=n(g),0==n(g)%2&&(w.dx=3*-Math.random()-3),0==n(g)%3&&(y.dx=3*-Math.random()-5),0==n(g)%15&&(_.dx=3*-Math.random()-3),0==n(g)%15&&(x.dx=3*-Math.random()-3),1e4<g&&(m=!0,h.stop(),f.innerHTML="GAME CLEAR!!Restart: Press Enter Key or Click")},render:function(){e.render(),v.render(),w.render(),y.render(),_.render(),x.render()}})).start()},document.addEventListener("keyup",(function(t){m&&"Enter"==t.code&&(h.start(),m=!1,w.x=s.width,y.x=s.width,_.x=s.width,x.x=s.width,f.innerHTML="",l.innerHTML=0,g=0)})),document.addEventListener("click",(function(){m&&(h.start(),m=!1,w.x=s.width,y.x=s.width,_.x=s.width,x.x=s.width,f.innerHTML="",l.innerHTML=0,g=0)}))},function(t,e,i){"use strict";function n(t,e){dt[t]=dt[t]||[],dt[t].push(e)}function r(t,e){let i;!dt[t]||0>(i=dt[t].indexOf(e))||dt[t].splice(i,1)}function o(t,...e){dt[t]&&dt[t].map(t=>t(...e))}function s(){return at}function h(){return ct}function a(t){if(at=document.getElementById(t)||t||document.querySelector("canvas"),!at)throw Error("You must provide a canvas element for the game");return ct=at.getContext("2d"),ct.imageSmoothingEnabled=!1,o("init"),{canvas:at,context:ct}}function c(t){return new ut(t)}function d(t,e){return new URL(t,e).href}function u(t,e){return[t.replace(gt,""),t?e.replace(pt,""):e].filter(t=>t).join("/")}function l(t){return t.split(".").pop()}function f(t){let e=t.replace("."+l(t),"");return 2==e.split("/").length?e.replace(pt,""):e}function p(){window.__k||(window.__k={dm:mt,u:d,d:bt,i:xt})}function g(t){wt=t}function m(t){yt=t}function w(t){_t=t}function y(t){return p(),new Promise((e,i)=>{let n,r,s;return n=u(wt,t),xt[n]?e(xt[n]):(r=new Image,r.onload=function(){s=d(n,window.location.href),xt[f(t)]=xt[n]=xt[s]=this,o("assetLoaded",this,t),e(this)},r.onerror=function(){i("Unable to load image "+n)},void(r.src=n))})}function _(t){return new Promise((e,i)=>{let n,r,s,h;return n=new Audio,r=function(t){return{wav:"",mp3:t.canPlayType("audio/mpeg;"),ogg:t.canPlayType('audio/ogg; codecs="vorbis"'),aac:t.canPlayType("audio/aac;")}}(n),(t=[].concat(t).reduce((t,e)=>t||(r[l(e)]?e:null),0))?(s=u(yt,t),vt[s]?e(vt[s]):(n.addEventListener("canplay",(function(){h=d(s,window.location.href),vt[f(t)]=vt[s]=vt[h]=this,o("assetLoaded",this,t),e(this)})),n.onerror=function(){i("Unable to load audio "+s)},n.src=s,void n.load())):i("cannot play any of the audio formats provided"+t)})}function x(t){let e,i;return p(),e=u(_t,t),bt[e]?Promise.resolve(bt[e]):fetch(e).then(t=>{if(!t.ok)throw t;return t.clone().json().catch(()=>t.text())}).then(n=>(i=d(e,window.location.href),"object"==typeof n&&mt.set(n,i),bt[f(t)]=bt[e]=bt[i]=n,o("assetLoaded",n,t),n))}function v(...t){return p(),Promise.all(t.map(t=>{let e=l([].concat(t)[0]);return e.match(lt)?y(t):e.match(ft)?_(t):x(t)}))}function b(){let t=s();h().clearRect(0,0,t.width,t.height)}function S({fps:t=60,clearCanvas:e=!0,update:i,render:n}={}){function r(){if(h=requestAnimationFrame(r),a=performance.now(),c=a-s,s=a,!(1e3<c)){for(o("tick"),u+=c;u>=l;)d.update(f),u-=l;p(),d.render()}}if(!i||!n)throw Error("You must provide update() and render() functions");let s,h,a,c,d,u=0,l=1e3/t,f=1/t,p=e?b:St;return d={update:i,render:n,isStopped:!0,start(){s=performance.now(),this.isStopped=!1,requestAnimationFrame(r)},stop(){this.isStopped=!0,cancelAnimationFrame(h)},_frame:r,set _last(t){s=t}},d}function A(t){let e=Pt[t.code||t.which];Et[e]=!0,At[e]&&At[e](t)}function E(t){Et[Pt[t.code||t.which]]=!1}function P(){Et={}}function j(){var t=String.fromCharCode;let e;for(e=0;26>e;e++)Pt[e+65]=Pt["Key"+t(e+65)]=t(e+97);for(e=0;10>e;e++)Pt[48+e]=Pt["Digit"+e]=""+e;window.addEventListener("keydown",A),window.addEventListener("keyup",E),window.addEventListener("blur",P)}function L(t,e){[].concat(t).map(t=>At[t]=e)}function O(t){[].concat(t).map(t=>At[t]=0)}function k(t){return!!Et[t]}function I(t){let e=t.substr(t.search(/[A-Z]/));return e[0].toLowerCase()+e.substr(1)}function M(t,e){let i=t.indexOf(e);-1!==i&&t.splice(i,1)}function T(t,e){let i=t.prototype;i&&(!i._inc&&(i._inc={},i._bInc=function(t,e,...i){return this._inc[e].before.reduce((e,i)=>{let n=i(t,...e);return n||e},i)},i._aInc=function(t,e,i,...n){return this._inc[e].after.reduce((e,i)=>{let r=i(t,e,...n);return r||e},i)}),Object.getOwnPropertyNames(e).forEach(t=>{let n=I(t);i[n]&&(!i["_o"+n]&&(i["_o"+n]=i[n],i[n]=function(...t){let e=this._bInc(this,n,...t),r=i["_o"+n].call(this,...e);return this._aInc(this,n,r,...t)}),!i._inc[n]&&(i._inc[n]={before:[],after:[]}),t.startsWith("before")?i._inc[n].before.push(e[t]):t.startsWith("after")&&i._inc[n].after.push(e[t]))}))}function C(t,e){let i=t.prototype;i&&i._inc&&Object.getOwnPropertyNames(e).forEach(t=>{let n=I(t);t.startsWith("before")?M(i._inc[n].before,e[t]):t.startsWith("after")&&M(i._inc[n].after,e[t])})}function D(t,e){let i=t.prototype;i&&Object.getOwnPropertyNames(e).forEach(t=>{i[t]||(i[t]=e[t])})}function R(t,e){const i=e||Tt;let n=t.x,r=t.y;t.anchor&&(n-=t.width*t.anchor.x,r-=t.height*t.anchor.y);let o=i.x-st(n,ht(i.x,n+t.width)),s=i.y-st(r,ht(i.y,r+t.height));return o*o+s*s<i.radius*i.radius}function z(t){const e=t||Tt;let i,n,r=Lt.length?Lt:jt;for(let t=r.length-1;0<=t;t--)if(i=r[t],n=i.collidesWithPointer?i.collidesWithPointer(e):R(i,e),n)return i}function W(t){let e=void 0===t.button?"left":Mt[t.button];It[e]=!0,U(t,"onDown")}function Y(t){let e=void 0===t.button?"left":Mt[t.button];It[e]=!1,U(t,"onUp")}function H(t){U(t,"onOver")}function K(){It={}}function U(t,e){let i=s();if(!i)return;let n,r,o=i.height/i.offsetHeight,h=i.getBoundingClientRect(),a=-1!==["touchstart","touchmove","touchend"].indexOf(t.type);if(a){Tt.touches={};for(var c=0;c<t.touches.length;c++)Tt.touches[t.touches[c].identifier]={id:t.touches[c].identifier,x:(t.touches[c].clientX-h.left)*o,y:(t.touches[c].clientY-h.top)*o,changed:!1};for(c=t.changedTouches.length;c--;){const i=t.changedTouches[c].identifier;void 0!==Tt.touches[i]&&(Tt.touches[i].changed=!0),n=t.changedTouches[c].clientX,r=t.changedTouches[c].clientY;let s=z({id:i,x:(n-h.left)*o,y:(r-h.top)*o,radius:Tt.radius});s&&s[e]&&s[e](t),Ot[e]&&Ot[e](t,s)}}else n=t.clientX,r=t.clientY;if(Tt.x=(n-h.left)*o,Tt.y=(r-h.top)*o,t.preventDefault(),!a){let i=z();i&&i[e]&&i[e](t),Ot[e]&&Ot[e](t,i)}}function X(){let t=s();t.addEventListener("mousedown",W),t.addEventListener("touchstart",W),t.addEventListener("mouseup",Y),t.addEventListener("touchend",Y),t.addEventListener("touchcancel",Y),t.addEventListener("blur",K),t.addEventListener("mousemove",H),t.addEventListener("touchmove",H),n("tick",()=>{Lt.length=0,jt.map(t=>{Lt.push(t)}),jt.length=0})}function B(t){[].concat(t).map(t=>{t._r||(t._r=t.render,t.render=function(){jt.push(this),this._r()},kt.push(t))})}function N(t){[].concat(t).map(t=>{t.render=t._r,t._r=0;let e=kt.indexOf(t);-1!==e&&kt.splice(e,1)})}function $(t){return!!kt.includes(t)&&z()===t}function G(t){Ot.onDown=t}function q(t){Ot.onUp=t}function F(t){return!!It[t]}function J(t){return new Ct(t)}function Q(t,e){let i=[],n=e.x+e.width/2,r=e.y+e.height/2,o=t.y<r&&t.y+t.height>=e.y,s=t.y+t.height>=r&&t.y<e.y+e.height;return t.x<n&&t.x+t.width>=e.x&&(o&&i.push(0),s&&i.push(2)),t.x+t.width>=n&&t.x<e.x+e.width&&(o&&i.push(1),s&&i.push(3)),i}function V(t){return new Dt(t)}function Z(t,e,i={}){let n=new Rt(t,e);return i._c&&(n.clamp(i._a,i._b,i._d,i._e),n.x=t,n.y=e),n}function tt(t){return new zt(t)}function et(t){if(+t===t)return t;let e=[],i=t.split(".."),n=+i[0],r=+i[1],o=n;if(n<r)for(;o<=r;o++)e.push(o);else for(;o>=r;o--)e.push(o);return e}function it(t){return new Wt(t)}function nt(t,e){void 0===e?localStorage.removeItem(t):localStorage.setItem(t,JSON.stringify(e))}function rt(t){let e=localStorage.getItem(t);try{e=JSON.parse(e)}catch(e){}return e}function ot(t={}){function e(t){return 0|t/v.tileheight}function i(t){return 0|t/v.tilewidth}function n(){v.layers&&v.layers.map(t=>{t._d=!1,y[t.name]=t,!1!==t.visible&&v._r(t,w)})}function r(t){const{width:e,height:i}=s(),n=ht(t.width,e),r=ht(t.height,i);v.context.drawImage(t,v.sx,v.sy,n,r,0,0,n,r)}let{width:o,height:a,tilewidth:c,tileheight:d,context:u=h(),tilesets:l,layers:f}=t,p=o*c,g=a*d,m=document.createElement("canvas"),w=m.getContext("2d");m.width=p,m.height=g;let y={},_={},x=[],v=Object.assign({context:u,mapwidth:p,mapheight:g,_sx:0,_sy:0,_d:!1,get sx(){return this._sx},get sy(){return this._sy},set sx(t){this._sx=ht(st(0,t),p-s().width),x.forEach(t=>t.sx=this._sx)},set sy(t){this._sy=ht(st(0,t),g-s().height),x.forEach(t=>t.sy=this._sy)},render(){this._d&&(this._d=!1,this._p()),r(m)},renderLayer(t){let e=_[t],i=y[t];e||(e=document.createElement("canvas"),e.width=p,e.height=g,_[t]=e,v._r(i,e.getContext("2d"))),i._d&&(i._d=!1,e.getContext("2d").clearRect(0,0,e.width,e.height),v._r(i,e.getContext("2d"))),r(e)},layerCollidesWith(t,n){let r=n.x,o=n.y;n.anchor&&(r-=n.width*n.anchor.x,o-=n.height*n.anchor.y);let s=e(o),h=i(r),a=e(o+n.height),c=i(r+n.width),d=y[t];for(let t=s;t<=a;t++)for(let e=h;e<=c;e++)if(d.data[e+t*this.width])return!0;return!1},tileAtLayer(t,n){let r=n.row||e(n.y),o=n.col||i(n.x);return y[t]?y[t].data[o+r*v.width]:-1},setTileAtLayer(t,n,r){let o=n.row||e(n.y),s=n.col||i(n.x);y[t]&&(y[t]._d=!0,y[t].data[s+o*v.width]=r)},setLayer(t,e){y[t]&&(y[t]._d=!0,y[t].data=e)},addObject(t){x.push(t),t.sx=this._sx,t.sy=this._sy},removeObject(t){let e=x.indexOf(t);-1!==e&&(x.splice(e,1),t.sx=t.sy=0)},_r:function(t,e){e.save(),e.globalAlpha=t.opacity,(t.data||[]).map((t,i)=>{if(!t)return;let n;for(let e=v.tilesets.length-1;0<=e&&(n=v.tilesets[e],!(1<=t/n.firstgid));e--);let r=n.tilewidth||v.tilewidth,o=n.tileheight||v.tileheight,s=n.margin||0,h=n.image,a=t-n.firstgid,c=n.columns||0|h.width/(r+s),d=i%v.width*r,u=(0|i/v.width)*o;e.drawImage(h,a%c*(r+s),(0|a/c)*(o+s),r,o,d,u,r,o)}),e.restore()},_p:n,layerCanvases:_,layerMap:y},t);return v.tilesets.map(e=>{let i=(window.__k?window.__k.dm.get(t):"")||window.location.href;if(e.source){if(!window.__k)throw Error('You must use "load" or "loadData" to resolve tileset.source');let t=window.__k.d[window.__k.u(e.source,i)];if(!t)throw Error(`You must load the tileset source "${e.source}" before loading the tileset`);Object.keys(t).map(i=>{e[i]=t[i]})}if(""+e.image===e.image){if(!window.__k)throw Error('You must use "load" or "loadImage" to resolve tileset.image');let t=window.__k.i[window.__k.u(e.image,i)];if(!t)throw Error(`You must load the image "${e.image}" before loading the tileset`);e.image=t}}),n(),v}var st=Math.max,ht=Math.min;i.r(e),i.d(e,"Animation",(function(){return c})),i.d(e,"imageAssets",(function(){return xt})),i.d(e,"audioAssets",(function(){return vt})),i.d(e,"dataAssets",(function(){return bt})),i.d(e,"setImagePath",(function(){return g})),i.d(e,"setAudioPath",(function(){return m})),i.d(e,"setDataPath",(function(){return w})),i.d(e,"loadImage",(function(){return y})),i.d(e,"loadAudio",(function(){return _})),i.d(e,"loadData",(function(){return x})),i.d(e,"load",(function(){return v})),i.d(e,"init",(function(){return a})),i.d(e,"getCanvas",(function(){return s})),i.d(e,"getContext",(function(){return h})),i.d(e,"on",(function(){return n})),i.d(e,"off",(function(){return r})),i.d(e,"emit",(function(){return o})),i.d(e,"GameLoop",(function(){return S})),i.d(e,"keyMap",(function(){return Pt})),i.d(e,"initKeys",(function(){return j})),i.d(e,"bindKeys",(function(){return L})),i.d(e,"unbindKeys",(function(){return O})),i.d(e,"keyPressed",(function(){return k})),i.d(e,"registerPlugin",(function(){return T})),i.d(e,"unregisterPlugin",(function(){return C})),i.d(e,"extendObject",(function(){return D})),i.d(e,"initPointer",(function(){return X})),i.d(e,"pointer",(function(){return Tt})),i.d(e,"track",(function(){return B})),i.d(e,"untrack",(function(){return N})),i.d(e,"pointerOver",(function(){return $})),i.d(e,"onPointerDown",(function(){return G})),i.d(e,"onPointerUp",(function(){return q})),i.d(e,"pointerPressed",(function(){return F})),i.d(e,"Pool",(function(){return J})),i.d(e,"Quadtree",(function(){return V})),i.d(e,"Sprite",(function(){return tt})),i.d(e,"SpriteSheet",(function(){return it})),i.d(e,"setStoreItem",(function(){return nt})),i.d(e,"getStoreItem",(function(){return rt})),i.d(e,"TileEngine",(function(){return ot})),i.d(e,"Vector",(function(){return Z}));let at,ct,dt={};class ut{constructor({spriteSheet:t,frames:e,frameRate:i,loop:n=!0}={}){this.spriteSheet=t,this.frames=e,this.frameRate=i,this.loop=n;let{width:r,height:o,margin:s=0}=t.frame;this.width=r,this.height=o,this.margin=s,this._f=0,this._a=0}clone(){return c(this)}reset(){this._f=0,this._a=0}update(t=1/60){if(this.loop||this._f!=this.frames.length-1)for(this._a+=t;1<=this._a*this.frameRate;)this._f=++this._f%this.frames.length,this._a-=1/this.frameRate}render({x:t,y:e,width:i=this.width,height:n=this.height,context:r=h()}={}){let o=0|this.frames[this._f]/this.spriteSheet._f,s=0|this.frames[this._f]%this.spriteSheet._f;r.drawImage(this.spriteSheet.image,s*this.width+(2*s+1)*this.margin,o*this.height+(2*o+1)*this.margin,this.width,this.height,t,e,i,n)}}c.prototype=ut.prototype,c.class=ut;let lt=/(jpeg|jpg|gif|png)$/,ft=/(wav|mp3|ogg|aac)$/,pt=/^\//,gt=/\/$/,mt=new WeakMap,wt="",yt="",_t="",xt={},vt={},bt={};const St=()=>{};let At={},Et={},Pt={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"left",ArrowUp:"up",ArrowRight:"right",ArrowDown:"down",13:"enter",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"},jt=[],Lt=[],Ot={},kt=[],It={},Mt={0:"left",1:"middle",2:"right"},Tt={x:0,y:0,radius:5};class Ct{constructor({create:t,maxSize:e=1024}={}){let i;if(!t||!(i=t())||!(i.update&&i.init&&i.isAlive))throw Error("Must provide create() function which returns an object with init(), update(), and isAlive() functions");this._c=t,this.objects=[t()],this.size=0,this.maxSize=e}get(t={}){if(this.size===this.objects.length){if(this.size===this.maxSize)return;for(let t=0;t<this.size&&this.objects.length<this.maxSize;t++)this.objects.push(this._c())}let e=this.objects[this.size];return this.size++,e.init(t),e}getAliveObjects(){return this.objects.slice(0,this.size)}clear(){this.size=this.objects.length=0,this.objects.push(this._c())}update(t){let e,i=!1;for(let n=this.size;n--;)e=this.objects[n],e.update(t),e.isAlive()||(i=!0,this.size--);i&&this.objects.sort((t,e)=>e.isAlive()-t.isAlive())}render(){for(let t=this.size;t--;)this.objects[t].render()}}J.prototype=Ct.prototype,J.class=Ct;class Dt{constructor({maxDepth:t=3,maxObjects:e=25,bounds:i}={}){this.maxDepth=t,this.maxObjects=e;let n=s();this.bounds=i||{x:0,y:0,width:n.width,height:n.height},this._b=!1,this._d=0,this._o=[],this._s=[],this._p=null}clear(){this._s.map((function(t){t.clear()})),this._b=!1,this._o.length=0}get(t){for(let e,i,n=new Set;this._s.length&&this._b;){for(e=Q(t,this.bounds),i=0;i<e.length;i++)this._s[e[i]].get(t).forEach(t=>n.add(t));return Array.from(n)}return this._o.filter(e=>e!==t)}add(){let t,e,i,n;for(e=0;e<arguments.length;e++)if(i=arguments[e],Array.isArray(i))this.add.apply(this,i);else if(this._b)this._a(i);else if(this._o.push(i),this._o.length>this.maxObjects&&this._d<this.maxDepth){for(this._sp(),t=0;n=this._o[t];t++)this._a(n);this._o.length=0}}_a(t,e,i){for(e=Q(t,this.bounds),i=0;i<e.length;i++)this._s[e[i]].add(t)}_sp(t,e,i){if(this._b=!0,!this._s.length)for(t=0|this.bounds.width/2,e=0|this.bounds.height/2,i=0;4>i;i++)this._s[i]=V({bounds:{x:this.bounds.x+(1==i%2?t:0),y:this.bounds.y+(2<=i?e:0),width:t,height:e},maxDepth:this.maxDepth,maxObjects:this.maxObjects}),this._s[i]._d=this._d+1,this._s[i]._p=this}}V.prototype=Dt.prototype,V.class=Dt;class Rt{constructor(t=0,e=0){this._x=t,this._y=e}add(t,e=1){return Z(this.x+(t.x||0)*e,this.y+(t.y||0)*e,this)}clamp(t,e,i,n){this._c=!0,this._a=t,this._b=e,this._d=i,this._e=n}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?ht(st(this._a,t),this._d):t}set y(t){this._y=this._c?ht(st(this._b,t),this._e):t}}Z.prototype=Rt.prototype,Z.class=Rt;class zt{constructor(t){this.init(t)}init(t={}){let{x:e,y:i,dx:n,dy:r,ddx:o,ddy:s,width:a,height:c,image:d}=t;for(let a in this.position=Z(e,i),this.velocity=Z(n,r),this.acceleration=Z(o,s),this._fx=this._fy=1,this.width=this.height=this.rotation=0,this.ttl=1/0,this.anchor={x:0,y:0},this.context=h(),t)this[a]=t[a];d&&(this.width=void 0===a?d.width:a,this.height=void 0===c?d.height:c),this.sx=0,this.sy=0}get x(){return this.position.x}get y(){return this.position.y}get dx(){return this.velocity.x}get dy(){return this.velocity.y}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}get animations(){return this._a}get viewX(){return this.x-this.sx}get viewY(){return this.y-this.sy}get width(){return this._w}get height(){return this._h}set x(t){this.position.x=t}set y(t){this.position.y=t}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}set animations(t){let e,i;for(e in this._a={},t)this._a[e]=t[e].clone(),i=i||this._a[e];this.currentAnimation=i,this.width=this.width||i.width,this.height=this.height||i.height}set viewX(t){}set viewY(t){}set width(t){let e=0>t?-1:1;this._fx=e,this._w=t*e}set height(t){let e=0>t?-1:1;this._fy=e,this._h=t*e}isAlive(){return 0<this.ttl}collidesWith(t){if(this.rotation||t.rotation)return null;let e=this.x-this.width*this.anchor.x,i=this.y-this.height*this.anchor.y,n=t.x,r=t.y;return t.anchor&&(n-=t.width*t.anchor.x,r-=t.height*t.anchor.y),e<n+t.width&&e+this.width>n&&i<r+t.height&&i+this.height>r}update(t){this.advance(t)}render(){this.draw()}playAnimation(t){this.currentAnimation=this.animations[t],this.currentAnimation.loop||this.currentAnimation.reset()}advance(t){this.velocity=this.velocity.add(this.acceleration,t),this.position=this.position.add(this.velocity,t),this.ttl--,this.currentAnimation&&this.currentAnimation.update(t)}draw(){let t=-this.width*this.anchor.x,e=-this.height*this.anchor.y;if(this.context.save(),this.context.translate(this.viewX,this.viewY),this.rotation&&this.context.rotate(this.rotation),-1==this._fx||-1==this._fy){let i=this.width/2+t,n=this.height/2+e;this.context.translate(i,n),this.context.scale(this._fx,this._fy),this.context.translate(-i,-n)}this.image?this.context.drawImage(this.image,0,0,this.image.width,this.image.height,t,e,this.width,this.height):this.currentAnimation?this.currentAnimation.render({x:t,y:e,width:this.width,height:this.height,context:this.context}):(this.context.fillStyle=this.color,this.context.fillRect(t,e,this.width,this.height)),this.context.restore()}}tt.prototype=zt.prototype,tt.class=zt;class Wt{constructor({image:t,frameWidth:e,frameHeight:i,frameMargin:n,animations:r}={}){if(!t)throw Error("You must provide an Image for the SpriteSheet");this.animations={},this.image=t,this.frame={width:e,height:i,margin:n},this._f=0|t.width/e,this.createAnimations(r)}createAnimations(t){let e,i;for(i in t){let{frames:n,frameRate:r,loop:o}=t[i];if(e=[],void 0===n)throw Error("Animation "+i+" must provide a frames property");[].concat(n).map(t=>{e=e.concat(et(t))}),this.animations[i]=c({spriteSheet:this,frames:e,frameRate:r,loop:o})}}}it.prototype=Wt.prototype,it.class=Wt,e.default={Animation:c,imageAssets:xt,audioAssets:vt,dataAssets:bt,setImagePath:g,setAudioPath:m,setDataPath:w,loadImage:y,loadAudio:_,loadData:x,load:v,init:a,getCanvas:s,getContext:h,on:n,off:r,emit:o,GameLoop:S,keyMap:Pt,initKeys:j,bindKeys:L,unbindKeys:O,keyPressed:k,registerPlugin:T,unregisterPlugin:C,extendObject:D,initPointer:X,pointer:Tt,track:B,untrack:N,pointerOver:$,onPointerDown:G,onPointerUp:q,pointerPressed:F,Pool:J,Quadtree:V,Sprite:tt,SpriteSheet:it,setStoreItem:nt,getStoreItem:rt,TileEngine:ot,Vector:Z}},function(){},function(){}]);
//# sourceMappingURL=app.js.map